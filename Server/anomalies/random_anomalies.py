# To generate fake data for the anomalies

import random
from datetime import datetime

# random_nodes = [
#     (15.294585713726294, 73.97480625932315),
#     (15.326573821514078, 73.93878316488733),
#     (15.283343051341562, 73.97073532231057),
#     (15.291602751237445, 73.93006440045144),
#     (15.26383289851605, 73.9266754085948),
#     (15.262353825916735, 73.94970884652842),
#     (15.264715460532827, 73.96021786318795),
#     (15.281443889329339, 73.9601701303196),
#     (15.286731326010987, 73.95454303703903),
#     (15.282928287651622, 73.9828746325961),
#     (15.285712329207067, 73.9837846952596),
#     (15.250538110752103, 73.98384416892333),
#     (15.277993389281237, 73.921000136724),
#     (15.275746543331746, 73.91487559592154),
#     (15.27133937729502, 74.0019736123654),
#     (15.312141256499444, 73.96132279338254),
#     (15.29255937028223, 73.9709234107157),
#     (15.301228756830243, 73.93250580708586),
#     (15.276715338141377, 73.91437614820798),
#     (15.294997937768935, 73.97281328973196),
#     (15.273500131580196, 73.94386204463932),
#     (15.279723817613194, 73.98586888982766),
#     (15.26836569875048, 73.96640391111605),
#     (15.247015607123194, 73.94026841328592),
#     (15.279631873582389, 73.9684539883735),
#     (15.27583355678967, 73.98454868258297),
#     (15.321352999731912, 73.94429307142514),
#     (15.275832240978366, 73.93065074141109),
#     (15.308570485918407, 74.00102288427539),
#     (15.329643213448435, 73.9740293341356),
#     (15.269672539459968, 73.95912127327395),
#     (15.257876501830827, 73.97901138550795),
#     (15.32704567422244, 73.97232961869769),
#     (15.278124611990437, 73.96299590154078),
#     (15.28119201584003, 73.97322385055197),
#     (15.27601713646467, 73.93390333356247),
#     (15.244382727788228, 73.98031891992943),
#     (15.287943756054103, 73.98475206856736),
#     (15.290927610542337, 73.97301519582625),
#     (15.29442711645292, 73.91918052610782),
#     (15.282294091361218, 73.98927083749732),
#     (15.260361120511824, 73.97983352908345),
#     (15.269734869807868, 73.92395964994108),
#     (15.26749663679707, 73.97578684244637),
#     (15.287986190911528, 73.976058426023),
#     (15.278826042131477, 73.99177604545028),
#     (15.279929203236566, 73.99198422314038),
#     (15.296873695345983, 73.9702396069567),
#     (15.240573120889012, 73.94126186133326),
#     (15.270812254363294, 73.95684995090801),
#     (15.329865419959008, 73.93312996833708),
#     (15.2907982, 73.96141799111349),
#     (15.284639288865009, 73.9598609406527),
#     (15.322789211596243, 73.93396498609731),
#     (15.25653478093724, 73.97424926585659),
#     (15.273982982130265, 73.97303613793262),
#     (15.271560775790874, 73.9785027232389),
#     (15.288076124973179, 74.00559205263444),
#     (15.273318539198891, 73.95805724736111),
#     (15.279261105676566, 73.97705204462467),
#     (15.290290610421634, 73.96398925050202),
#     (15.282428159637611, 73.9608236161922),
#     (15.277461864061864, 73.91397505736136),
#     (15.288738602824465, 73.9590718464037),
#     (15.295685121199817, 73.99059680599703),
#     (15.283649942281944, 73.95749385235247),
#     (15.258554136760237, 73.99474947828728),
#     (15.258605260998204, 73.93932696761846),
#     (15.280417239076623, 73.98745527978703),
#     (15.324330220181224, 73.93799997314656),
#     (15.276916527761443, 73.98829362849284),
#     (15.282832788308935, 73.97744652816216),
#     (15.283165948096402, 73.97397371065479),
#     (15.278896368245771, 73.96270854297948),
#     (15.307635605907448, 73.97184457182746),
#     (15.306720940805587, 73.94876824677473),
#     (15.295156183456802, 73.98833424029813),
#     (15.315407086828856, 73.95879804676913),
#     (15.247422146252761, 73.93852517560408),
#     (15.315958401816612, 73.94143207574662),
#     (15.262887888078907, 73.95633690426756),
#     (15.272997689724969, 73.95825185834526),
#     (15.276064256053152, 73.97474004096856),
#     (15.29194618941784, 73.96880588647015),
#     (15.288576937478904, 74.00087371742575),
#     (15.238312463170356, 73.9576434508901),
#     (15.251818391354806, 73.9684678576494),
#     (15.274447972023687, 73.96334855866327),
#     (15.249618247238454, 73.96651929309232),
#     (15.285899520424163, 73.95295672980396),
#     (15.276526199298297, 73.91579003584833),
#     (15.283993674958436, 73.96910151801117),
#     (15.262991398336679, 73.92737486735177),
#     (15.268356634670988, 73.96433157646808),
#     (15.277801711766575, 73.92097604550159),
#     (15.29559487574926, 73.95676294695551),
#     (15.292858624232057, 73.9700596614728),
#     (15.298010488342209, 73.95139297743349),
#     (15.268411434491929, 73.9232508),
#     (15.280420081758578, 73.91890057892849),
# ]


# some more locations to add anomalies
# 10 on a regularly tested path
# random_nodes = [
# (15.595165720169268, 73.81769442284701),
# (15.599380310317256, 73.82361969716123),
# (15.593053804257998, 73.81243564337301),
# (15.595601497951229, 73.81653583370972),
# (15.600828789489459, 73.82592606166986),
# (15.597138935403796, 73.8212015617337),
# (15.601118897692308, 73.82608392747636),
# (15.594713957435648, 73.81338355247273),
# (15.595556571619342, 73.81594179953235),
# (15.60092303252846, 73.8244165705312),
#
# (15.600303670825703, 73.82581106464045),
# (15.600338867473592, 73.8258112644322),
# (15.600495736818653, 73.82581215489206),
# ]


random_nodes = [(15.408843643134317,	73.99236453940408),
(15.408616523554269,	73.99234966031383),
(15.408606140479861,	73.99216691636063),
(15.40886919986314,	73.99232870339735),
(15.369554389093324,	74.00957121340558),
(15.370332500870001,	74.00979171344095),
(15.370646519987641,	74.00987725520677),
(15.416092607755788,	73.98637357872974),
(15.413724317311832,	73.98822606027919),
(15.419550617051923,	73.98136087827963),
(15.413396676662376,	73.98854438966775),
(15.413205771385945,	73.98857185405302),
(15.412898305144097,	73.98870005122889),
(15.413536537908353,	73.98851884284946),
(15.413608361583487,	73.98845887738116),
(15.401535125403166,	73.99087277788179),
(15.400875384309845,	73.99232416107654),
(15.400845201600589,	73.9925448183243),
(15.400706737252303,	73.99315707056222),
(15.400395341675933,	73.99343531676902),
(15.397762010765723,	73.99524880865361),
(15.397302336623591,	73.99555014394947),
(15.39429072492869,	73.99657574146846),
(15.392226428887477,	73.99608538267604),
(15.388330520894934,	73.99810416207957),
(15.409066090848938,	73.99216680944289),
(15.410301693755716,	73.99125343632639),
(15.410415453738283,	73.99115018558068),
(15.410748730712237,	73.99080170775744),
(15.412387310419758,	73.98910074763107),
(15.41287053216001,	73.98871746314161),
(15.419084437678146,	73.98096581855272),
(15.419831083615302,	73.98225940310607),
(15.41961417510286,	73.98249248184968),
(15.419117059307409,	73.98382357506533),
(15.372662980781483,	74.01072030029505),
(15.37327413820007,	74.01098657488015),
(15.373138677016135,	74.01101637378056),
(15.422974473864182,	73.98131784455035),
(15.423174836953539,	73.98131871100205),
(15.422906276774839,	73.98013057566742),
(15.423401271489885,	73.98030426179233),
(15.423407905790913,	73.98033898085261),
(15.373593913535032,	74.01032673676475),
(15.42106979361573,	73.98174546776492),
(15.42142158683265,	73.98166059992967),
(15.421899195840234,	73.9815589774065),
(15.42247207850274,	73.9813195655576),
(15.418772223202994,	73.98048053892794),
(15.419067173993817,	73.98019484257321),
(15.419144133814243,	73.98021996671679),
(15.419455760253369,	73.98031148552371),
(15.419620776226234,	73.9803706716057),
(15.418980387885943,	73.98334276203109),
(15.402022903622647,	73.99073206909875),
(15.402102230831215,	73.99071442534051),
(15.403571722585243,	73.99039512777341),
(15.407135711701907,	73.9921148464722),
(15.404915855434242,	73.99012678764878),
(15.36881382794604,	74.01115793104981),
(15.369265313517747,	74.0097864157319),
(15.387746949968136,	73.99864318588641),
(15.386987593980168,	73.99945453629668),
(15.384975976992864,	74.00071952287306),
(15.384846892321903,	74.00102959060685),
(15.384276959252682,	74.0017564916597),
(15.382761982074566,	74.00540989906071),
(15.379966147186803,	74.00725134116246),
(15.377216263600289,	74.00845469379747),
(15.420825334009258,	73.98092607887708),
(15.421092909173968,	73.98110749289373),]

# Query to get random locations that lie on edges
# SELECT ST_LineInterpolatePoint(geom_way, RANDOM()) from edges where id_new in 
# (2512169561, 2512169700, 10157115262, 2512169596, 2512169595, 2512169594, 2512169593, 2512169592, 2512169591, 2512169590, 10157115316, 10157115317, 13278333361, 9911024470, 9911024461, 102103419013, 102103419012, 102103419011, 102103419010, 10210341909, 10210341908, 10210341907, 10210341906, 10210341905, 10210341904, 10210341903, 10210341902, 10210341901, 4313786510, 4313786511, 2510733402, 2510733401, 2510733400, 11810053872, 9911095710, 11818431704, 11818431712, 11822203090, 11822203091, 2510733440, 2510733441, 9911095610)

# ORDER BY RANDOM()
# LIMIT 10;



metres_per_degree = 111139

id = 1000 + 13*10 # Change as needed. Each random point adds 10 new entries
with open("./out.csv", "w+") as f:
    f.write(f"id,\tlongitude,\tlatitude,\tanomaly_type,\tconfidence,\tcreated_at\n")
    for _lat, _long in random_nodes:
        a_type= random.choice(['Pothole', 'SpeedBreaker', 'Rumbler', 'Cracks'])
        default_timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        for i in range(0, 10):
            r_lat, r_long = (
                _lat + random.randint(-10, 10) / metres_per_degree,
                _long + random.randint(-10, 10) / metres_per_degree,
            )
            conf = random.random()
            f.write(f"{id},\t{r_long},\t{r_lat},{a_type},\t{conf},\t{default_timestamp}\n")
            id += 1

